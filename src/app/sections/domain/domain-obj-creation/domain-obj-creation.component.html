<cc-page-layout title="Create">
    <mat-card>
        <mat-card-content class="content">
            <cc-thrift-editor
                *ngIf="!review"
                [extensions]="extensions$ | async"
                [formControl]="control"
                [metadata]="metadata$ | async"
                class="editor"
                namespace="domain"
                type="DomainObject"
            ></cc-thrift-editor>
            <cc-thrift-viewer
                *ngIf="review"
                [extensions]="viewerExtensions$ | async"
                [metadata]="metadata$ | async"
                [value]="control.value"
                class="editor"
                namespace="domain"
                type="DomainObject"
            ></cc-thrift-viewer>
        </mat-card-content>
    </mat-card>
    <v-actions>
        <button *ngIf="!review" [disabled]="!!(progress$ | async)" mat-button routerLink="/domain">
            <mat-icon aria-label="Login">keyboard_arrow_left</mat-icon>
            Back to domain
        </button>
        <button
            *ngIf="review"
            [disabled]="!!(progress$ | async)"
            mat-button
            (click)="review = false"
        >
            <mat-icon aria-label="Login">keyboard_arrow_left</mat-icon>
            Back to edit
        </button>

        <button
            [disabled]="control.invalid || !!(progress$ | async)"
            color="primary"
            mat-button
            (click)="review ? commit() : reviewChanges()"
        >
            {{ review ? 'Commit' : 'Review' }}
            <mat-icon aria-label="Login">keyboard_arrow_right</mat-icon>
        </button>
    </v-actions>
</cc-page-layout>
